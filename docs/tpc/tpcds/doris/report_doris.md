# Apache Doris

## 导入

> 基于 Stream Load 模式导入数据

**1GB**

| TableName              | NumberTotalRows | LoadBytes | LoadTimeMs | ReadDataTimeMs | WriteDataTimeMs |
| ---------------------- | :-------------: | :-------: | :--------: | :------------: | :-------------: |
| dbgen_version          |        1        |    84     |    1272    |       0        |       292       |
| customer_address       |      50000      |  5452165  |    1530    |       15       |      1487       |
| customer_demographics  |     1920800     | 78739296  |    4465    |      732       |      4316       |
| date_dim               |      73049      | 10244389  |    643     |       12       |       605       |
| warehouse              |        5        |    580    |     66     |       0        |       31        |
| ship_mode              |       20        |   1093    |    270     |       0        |       219       |
| time_dim               |      86400      |  5021380  |    512     |       8        |       471       |
| reason                 |       35        |   1304    |     49     |       0        |       20        |
| income_band            |       20        |    308    |    257     |       0        |       230       |
| item                   |      18000      |  5033899  |    294     |       6        |       262       |
| store                  |       12        |   3143    |     92     |       0        |       45        |
| call_center            |        6        |   1885    |     61     |       0        |       33        |
| customer               |     100000      | 13110282  |    784     |       60       |       743       |
| web_site               |       30        |   8741    |    138     |       0        |       101       |
| store_returns          |     287514      | 32422491  |    2378    |      315       |      2311       |
| household_demographics |      7200       |  144453   |    323     |       0        |       292       |
| web_page               |       60        |   5716    |    332     |       0        |       298       |
| promotion              |       300       |   36933   |     85     |       0        |       40        |
| catalog_page           |      11718      |  1620074  |    132     |       1        |       105       |
| inventory              |    11745000     | 224675139 |   49289    |      9067      |      48482      |
| catalog_returns        |     144067      | 21234304  |    1485    |      247       |      1441       |
| web_returns            |      71763      |  9734473  |    923     |       7        |       881       |
| web_sales              |     719384      | 146158290 |    7662    |      2470      |      7590       |
| catalog_sales          |     1441548     | 294468836 |   44709    |      7881      |      44587      |
| store_sales            |     2880404     | 385565005 |   54638    |     16305      |      54329      |

**10GB**

| TableName              | NumberTotalRows | LoadBytes  | LoadTimeMs | ReadDataTimeMs | WriteDataTimeMs |
| ---------------------- | :-------------: | :--------: | :--------: | :------------: | :-------------: |
| dbgen_version          |        1        |     77     |    116     |       0        |       66        |
| customer_address       |     250000      |  27457596  |    2332    |       45       |      2254       |
| customer_demographics  |     1920800     |  78739296  |    4802    |      311       |      4646       |
| date_dim               |      73049      |  10244389  |    965     |       11       |       927       |
| warehouse              |       10        |    1176    |     67     |       0        |       27        |
| ship_mode              |       20        |    1093    |    126     |       0        |       89        |
| time_dim               |      86400      |  5021380   |    647     |       3        |       617       |
| reason                 |       45        |    1604    |    411     |       0        |       381       |
| income_band            |       20        |    308     |    277     |       0        |       248       |
| item                   |     102000      |  28753325  |    1135    |      112       |      1082       |
| store                  |       102       |   26983    |     80     |       0        |       50        |
| call_center            |       24        |    7520    |     73     |       0        |       42        |
| customer               |     500000      |  66377545  |    2829    |      267       |      2769       |
| web_site               |       42        |   12125    |    263     |       0        |       236       |
| store_returns          |     2875432     | 335488115  |   51590    |     13310      |      51366      |
| household_demographics |      7200       |   144453   |    310     |       0        |       272       |
| web_page               |       200       |   19131    |     94     |       0        |       67        |
| promotion              |       500       |   61659    |     65     |       0        |       37        |
| catalog_page           |      12000      |  1659048   |    421     |       1        |       371       |
| inventory              |    133110000    | 2629887971 |   474442   |     405516     |     469433      |
| catalog_returns        |     1439749     | 220138943  |   29536    |     15140      |      29272      |
| web_returns            |     719217      | 101336920  |    5774    |      1002      |      5690       |
| web_sales              |     7197566     | 1504223803 |   113958   |     106644     |     112411      |
| catalog_sales          |    14401261     | 3023483057 |   254045   |     188260     |     249031      |
| store_sales            |    28800991     | 3970120305 |   437943   |     404856     |     432924      |

**50GB**

| TableName              | NumberTotalRows |  LoadBytes  | LoadTimeMs | ReadDataTimeMs | WriteDataTimeMs |
| ---------------------- | :-------------: | :---------: | :--------: | :------------: | :-------------: |
| dbgen_version          |        1        |     77      |    572     |       0        |       337       |
| customer_address       |     383000      |  42122965   |    2903    |      144       |      2851       |
| customer_demographics  |     1920800     |  78739296   |    5469    |      419       |      5306       |
| date_dim               |      73049      |  10244389   |    1027    |       17       |       988       |
| warehouse              |        7        |     819     |    184     |       0        |       152       |
| ship_mode              |       20        |    1093     |    397     |       0        |       365       |
| time_dim               |      86400      |   5021380   |    783     |       3        |       748       |
| reason                 |       39        |    1424     |    220     |       0        |       189       |
| income_band            |       20        |     308     |     53     |       0        |       23        |
| item                   |      62000      |  17422880   |    1768    |       89       |      1741       |
| store                  |       144       |    38318    |     74     |       0        |       48        |
| call_center            |        8        |    2514     |    413     |       0        |       377       |
| customer               |     766000      |  101879661  |    5272    |      502       |      5210       |
| web_site               |       22        |    6233     |     79     |       0        |       47        |
| store_returns          |    14392680     | 1692765169  |   206047   |     157313     |     201038      |
| household_demographics |      7200       |   144453    |    310     |       0        |       274       |
| web_page               |       876       |    83936    |     68     |       0        |       41        |
| promotion              |       522       |    64362    |    709     |       0        |       677       |
| catalog_page           |      11718      |   1620074   |    542     |       1        |       517       |
| inventory              |    56638827     | 1108270494  |   192276   |     114041     |     187266      |
| catalog_returns        |     7197954     | 1102047325  |   118357   |     72817      |     116157      |
| web_returns            |     3598924     |  512706117  |   64687    |     22634      |      64414      |
| web_sales              |    35996850     | 7571159176  |   552382   |     501452     |     547362      |
| catalog_sales          |    71997669     | 15133562134 |  1087186   |     985311     |     1082175     |
| store_sales            |    144004764    | 19991955111 |  2227896   |    2178507     |     2222867     |

> 注意：对于大数据量的导入 Apache Doris，提交事务耗时会比较长，且在此期间数据是不可见的，故查询会没有数据，且比较严重影响查询性能

## 查询

> 返回结果取 `limit 100` 控制


<!--

| Query SQL |  1GB-耗时【单位毫秒】   |   10GB-耗时【单位秒】    |
| --------- | :---------------------: | :----------------------: |
| query1    |           266           |          2.415           |
| query2    |           327           |          1.950           |
| query3    |           100           |          314ms           |
| query4    |           775           |          5.646           |
| query5    |          1.5s           |          1.497           |
| query6    |           295           |          862ms           |
| query7    |           176           |          758ms           |
| query8    |       152(无数据)       |          550ms           |
| query9    |           173           |          637ms           |
| query10   |           193           |          581ms           |
| query11   |           614           |           4.40           |
| query12   |           153           |          179ms           |
| query13   |           245           |          773ms           |
| query14   |    4.583s(两条语句)     |          14.410          |
| query15   |           238           |          359ms           |
| query16   |           279           |          2.752           |
| query17   |           434           |      1.135(无数据)       |
| query18   |           534           |           1.11           |
| query19   |           223           |          630ms           |
| query20   |           152           |          223ms           |
| query21   |           116           |          417ms           |
| query22   |           636           |          6.959           |
| query23   | 1.803(无数据，两条语句) | 13.777(无数据，两条语句) |
| query24   |       838(无数据)       |          2.268           |
| query25   |       221(无数据)       |          888ms           |
| query26   |           219           |          286ms           |
| query27   |           175           |          517ms           |
| query28   |           198           |          777ms           |
| query29   |           446           |          1.976           |
| query30   |           195           |          315ms           |
| query31   |           295           |          682ms           |
| query32   |           123           |          247ms           |
| query33   |           150           |          331ms           |
| query34   |           272           |          398ms           |
| query35   |           218           |          514ms           |
| query36   |           203           |          536ms           |
| query37   |       194(无数据)       |          1.586           |
| query38   |           305           |          1.482           |
| query39   |      380(两条语句)      |          1.619           |
| query40   |           107           |           1.17           |
| query41   |           80            |           86ms           |
| query42   |           89            |          164ms           |
| query43   |           183           |          361ms           |
| query44   |           128           |          387ms           |
| query45   |           224           |          570ms           |
| query46   |           432           |          770ms           |
| query47   |           447           |          1.573           |
| query48   |           177           |          813ms           |
| query49   |           267           |          876ms           |
| query50   |           152           |          426ms           |
| query51   |          1.10s          |          7.469           |
| query52   |           91            |          161ms           |
| query53   |           102           |          244ms           |
| query54   |       480(无数据)       |      6.453(无数据)       |
| query55   |           78            |          134ms           |
| query56   |           391           |          330ms           |
| query57   |           253           |          912ms           |
| query58   |       265(无数据)       |          566ms           |
| query59   |           616           |          5.383           |
| query60   |           155           |          408ms           |
| query61   |       166(无数据)       |      173ms(无数据)       |
| query62   |           125           |          349ms           |
| query63   |           122           |          243ms           |
| query64   |         2.379s          |          2.553           |
| query65   |           151           |          1.164           |
| query66   |           284           |          757ms           |
| query67   |         1.465s          |          17.998          |
| query68   |           401           |          708ms           |
| query69   |           148           |          284ms           |
| query70   |           216           |          944ms           |
| query71   |           109           |          366ms           |
| query72   |           428           |          3.145           |
| query73   |           249           |          396ms           |
| query74   |           321           |          2.152           |
| query75   |           235           |          1.176           |
| query76   |           134           |          272ms           |
| query77   |           152           |          334ms           |
| query78   |         1.870s          |          12.284          |
| query79   |           316           |          693ms           |
| query80   |           206           |          965ms           |
| query81   |           231           |           1.90           |
| query82   |           286           |          2.424           |
| query83   |           155           |          380ms           |
| query84   |           146           |          228ms           |
| query85   |           307           |          693ms           |
| query86   |           127           |          269ms           |
| query87   |           272           |          1.436           |
| query88   |           160           |          460ms           |
| query89   |           143           |          287ms           |
| query90   |           88            |          110ms           |
| query91   |           97            |          283ms           |
| query92   |       128(无数据)       |          225ms           |
| query93   |       159(无数据)       |       859(无数据)        |
| query94   |           177           |           1.49           |
| query95   |         2.153s          |          33.639          |
| query96   |           82            |          2.311           |
| query97   |           177           |          2.982           |
| query98   |           198           |          2.349           |
| query99   |           150           |          2.386           |
| DATE      |    2023-07-19 15:48     |     2023-07-20 10:25     |

-->

| Query SQL |  1GB-耗时【单位毫秒】   |   10GB-耗时【单位秒】    |         50GB-耗时         |
| --------- | :---------------------: | :----------------------: | :-----------------------: |
| query1    |           266           |          2.415           |          2.318s           |
| query2    |           327           |          1.950           |          4.809s           |
| query3    |           100           |          314ms           |          3.629s           |
| query4    |           775           |          5.646           |          23.20s           |
| query5    |          1.5s           |          1.497           |          6.475s           |
| query6    |           295           |          862ms           |          4.307s           |
| query7    |           176           |          758ms           |          7.373s           |
| query8    |       152(无数据)       |          550ms           |          2.737s           |
| query9    |           173           |          637ms           |          5.971s           |
| query10   |           193           |          581ms           |          1.982s           |
| query11   |           614           |           4.40           |          15.710s          |
| query12   |           153           |          179ms           |          1.506s           |
| query13   |           245           |          773ms           |          5.664s           |
| query14   |    4.583s(两条语句)     |          14.410          |          45.754s          |
| query15   |           238           |          359ms           |          2.819s           |
| query16   |           279           |          2.752           |          11.458s          |
| query17   |           434           |      1.135(无数据)       |          5.415s           |
| query18   |           534           |           1.11           |          6.529s           |
| query19   |           223           |          630ms           |          2.884s           |
| query20   |           152           |          223ms           |          1.392s           |
| query21   |           116           |          417ms           |          1.798s           |
| query22   |           636           |          6.959           |          3.858s           |
| query23   | 1.803(无数据，两条语句) | 13.777(无数据，两条语句) | 54.586s(两条语句都有数据) |
| query24   |       838(无数据)       |          2.268           |          12.144s          |
| query25   |       221(无数据)       |          888ms           |          4.560s           |
| query26   |           219           |          286ms           |          3.218s           |
| query27   |           175           |          517ms           |          3.921s           |
| query28   |           198           |          777ms           |           5.61s           |
| query29   |           446           |          1.976           |          6.490s           |
| query30   |           195           |          315ms           |          1.625s           |
| query31   |           295           |          682ms           |          7.331s           |
| query32   |           123           |          247ms           |          2.140s           |
| query33   |           150           |          331ms           |          3.162s           |
| query34   |           272           |          398ms           |          2.373s           |
| query35   |           218           |          514ms           |          2.284s           |
| query36   |           203           |          536ms           |          2.574s           |
| query37   |       194(无数据)       |          1.586           |      1.823s(无数据)       |
| query38   |           305           |          1.482           |          8.506s           |
| query39   |      380(两条语句)      |          1.619           |          4.731s           |
| query40   |           107           |           1.17           |          4.319s           |
| query41   |           80            |           86ms           |           407ms           |
| query42   |           89            |          164ms           |          1.689s           |
| query43   |           183           |          361ms           |          3.504s           |
| query44   |           128           |          387ms           |          2.826s           |
| query45   |           224           |          570ms           |          2.731s           |
| query46   |           432           |          770ms           |           5.8s            |
| query47   |           447           |          1.573           |           5.17s           |
| query48   |           177           |          813ms           |          1.830s           |
| query49   |           267           |          876ms           |          9.309s           |
| query50   |           152           |          426ms           |          4.436s           |
| query51   |          1.10s          |          7.469           |          15.153s          |
| query52   |           91            |          161ms           |           969ms           |
| query53   |           102           |          244ms           |          1.460s           |
| query54   |       480(无数据)       |      6.453(无数据)       |    查询内存过大，报错     |
| query55   |           78            |          134ms           |          3.612s           |
| query56   |           391           |          330ms           |          3.697s           |
| query57   |           253           |          912ms           |          4.519s           |
| query58   |       265(无数据)       |          566ms           |           4.41s           |
| query59   |           616           |          5.383           |          24.519s          |
| query60   |           155           |          408ms           |          2.454s           |
| query61   |       166(无数据)       |      173ms(无数据)       |           357ms           |
| query62   |           125           |          349ms           |          1.869s           |
| query63   |           122           |          243ms           |          1.930s           |
| query64   |         2.379s          |          2.553           |          12.570s          |
| query65   |           151           |          1.164           |          3.140s           |
| query66   |           284           |          757ms           |          6.367s           |
| query67   |         1.465s          |          17.998          |           1m16s           |
| query68   |           401           |          708ms           |          5.699s           |
| query69   |           148           |          284ms           |          1.727s           |
| query70   |           216           |          944ms           |          5.866s           |
| query71   |           109           |          366ms           |          2.899s           |
| query72   |           428           |          3.145           |          44.852s          |
| query73   |           249           |          396ms           |          2.348s           |
| query74   |           321           |          2.152           |          8.375s           |
| query75   |           235           |          1.176           |           6.82s           |
| query76   |           134           |          272ms           |          2.405s           |
| query77   |           152           |          334ms           |           3.9s            |
| query78   |         1.870s          |          12.284          |    查询内存过大，报错     |
| query79   |           316           |          693ms           |          6.347s           |
| query80   |           206           |          965ms           |          7.291s           |
| query81   |           231           |           1.90           |          1.769s           |
| query82   |           286           |          2.424           |          1.856s           |
| query83   |           155           |          380ms           |          1.549s           |
| query84   |           146           |          228ms           |           943ms           |
| query85   |           307           |          693ms           |          3.274s           |
| query86   |           127           |          269ms           |          1.355s           |
| query87   |           272           |          1.436           |          6.701s           |
| query88   |           160           |          460ms           |          3.669s           |
| query89   |           143           |          287ms           |          2.664s           |
| query90   |           88            |          110ms           |          1.419s           |
| query91   |           97            |          283ms           |          1.176s           |
| query92   |       128(无数据)       |          225ms           |          2.130s           |
| query93   |       159(无数据)       |       859(无数据)        |      3.367s(无数据)       |
| query94   |           177           |           1.49           |           6.76s           |
| query95   |         2.153s          |          33.639          |    查询内存过大，报错     |
| query96   |           82            |          2.311           |          2.362s           |
| query97   |           177           |          2.982           |          9.222s           |
| query98   |           198           |          2.349           |          3.583s           |
| query99   |           150           |          2.386           |          2.946s           |
| DATE      |    2023-07-19 15:48     |     2023-07-20 10:25     |     2023-07-20 17:47      |

<!--

> `查询内存过大` 是在 16G 内存的情况下，内存已经撑到很高的内存情况下了，内存自身就不太够了，暂未优化

-->