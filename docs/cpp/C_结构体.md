# 结构体

> C 语言中的结构体是对一组数据元素的有序组织

## **定义**

结构体定义了一个包含多个成员的新的数据类型，结构体语句的格式如下：

```c
struct [tag] {
    member-list
    member-list
    member-list
    ...
} [variable-list];
```

- tag 是结构体标签
- member-list 是标准的变量定义，比如 int i; 或者 float f;，或者其他有效的变量定义
- variable-list 结构变量，定义在结构的末尾，最后一个分号之前，可以指定一个或多个结构变量

> 在一般情况下，tag、member-list、variable-list 这 3 部分至少要出现 2 个。

## **声明变量**

```c
// 声明结构体类型变量
struct structName varName;

// 声明结构体类型的指针变量
struct structName *pointVarName;
```

## 初始化

**按照结构体定义顺序进行初始化**

使用 `{}` 初始化结构的值，各项之间使用逗号（`,`）进行分隔。

****

## 调用

**调用成员变量**

访问一个结构体对象中某个成员使用 `.` 操作符。

**结构体类型指针调用成员变量**

访问一个指向结构体类型的指针，使用 `->` 操作符。

## typedef

> typedef 工具是一个高级数据特性，利用 typedef 可以为某一类型自定义名称。

typedef 用于给复杂类型命名。typedef 并没有创建任何新类型，它只是为某个已存在的类型增加了一个方便使用的标签。

**语法**

```c
typedef type newname;
```

## 联合

> 联合（union）是一种数据类型，它能在同一个内存空间中储存不同的数据类型（不是同时储存）。其典型的用法是，设计一种表以储存既无规律、事先也不知道顺序的混合类型。使用联合类型的数组，其中的联合都大小相等，每个联合可以储存各种数据类型。

建联合和创建结构的方式相同，需要一个联合模板和联合变量。可以用一个步骤定义联合，也可以用联合标记分两步定义。

*示例*

```c
union hold{
    int digit;
    double bigfl;
    char letter;
}
```

根据以上形式声明的结构可以储存一个 int 类型、一个 double 类型和 char 类型的值。然而，声明的联合只能储存一个 int 类型的值或一个 double 类型的值或 char 类型的值。

*对于联合结构，编译器会分配足够的空间以便它能存储联合声明中占用最大字节的类型。*

可以初始化联合。需要注意的是，联合只能储存一个值，这与结构不同。有 3 种初始化的方法：把一个联合初始化为另一个同类型的联合；初始化联合的第 1 个元素；或者根据C99标准，使用指定初始化器：

```c
union hold valA;
valA.letter='R';
union hold valB=valA;            // 用另一个联合来初始化
union hold valC={99};            // 初始化联合的digit成员
union hold valD={.bigfl=1.234};  // 指定初始化器
```

**联合用法**

*示例*

```c
fit.digit=23;   // 把 23 储存在 fit，占用 2 字节
fit.bigfl=2.0;  // 清除 23 ，储存 2.0，占用 8 字节
fit.letter='S'; // 清除 2.0，储存 h，占用 1 字节
```

在联合中，一次只储存一个值。即使有足够的空间，也不能同时储存一个 char 类型值和一个 int 类型值。