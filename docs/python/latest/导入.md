# 导入

## `import`

```py
import ...
import ... as ...
from ... import ...
from ... import ... as ...
```

## `_import_` 函数

`__import__` 函数可用于导入模块，import 语句也会调用函数。其定义为：

```py
__import__(name[, globals[, locals[, fromlist[, level]]]])
```

参数介绍：

- `name` (required): 被加载 module 的名称
- `globals` (optional): 包含全局变量的字典，该选项很少使用，采用默认值 `global()`
- `locals` (optional): 包含局部变量的字典，内部标准实现未用到该变量，采用默认值 - `local()`
- `fromlist` (Optional): 被导入的 submodule 名称
- `level` (Optional): 导入路径选项，Python 2 中默认为 `-1`，表示同时支持 absolute import 和 relative import。Python 3 中默认为 `0`，表示仅支持 absolute import。如果大于 `0`，则表示相对导入的父目录的级数，即 1 类似于 `.`，2 类似于 `..`。


使用示例如下：

```py
>>> os = __import__('os')
>>> os.getcwd()
'/home/wangbm'
```

如果要实现 `import xx as yy` 的效果，只要修改左值即可

如下示例，等价于 `import os as myos`：

```py
>>> myos = __import__('os')
>>> myos.getcwd()
'/home/wangbm'
```

上面说过的 `__import__` 是一个内建函数，既然是内建函数的话，那么这个内建函数必将存在于 `__buildins__` 中，因此我们还可以这样导入 os 的模块：

```py
>>> __builtins__.__dict__['__import__']('os').getcwd()
'/home/wangbm'
```

## `importlib` 模块

`importlib` 是 Python 中的一个标准库，`importlib` 能提供的功能非常全面。

示例：

```py
>>> import importlib
>>> os=importlib.import_module("os")
>>> os.getcwd()
'/home/wangbm'
```

如果要实现 `import xx as yy` 效果，可以这样

```py
>>> import importlib
>>> 
>>> myos = importlib.import_module("os")
>>> myos.getcwd()
'/home/wangbm'
```

## `imp` 模块

`imp` 模块提供了一些 import 语句内部实现的接口。例如模块查找（find_module）、模块加载（load_module）等等（模块的导入过程会包含模块查找、加载、缓存等步骤）。可以用该模块来简单实现内建的 `__import__` 函数功能：

```py
>>> import imp
>>> file, pathname, desc = imp.find_module('os')
>>> myos = imp.load_module('sep', file, pathname, desc)
>>> myos
<module 'sep' from '/usr/lib64/python2.7/os.pyc'>
>>> myos.getcwd()
'/home/wangbm'
```

从 python 3 开始，内建的 reload 函数被移到了 imp 模块中。而从 Python 3.4 开始，imp 模块被否决，不再建议使用，其包含的功能被移到了 importlib 模块下。即从 Python 3.4 开始，importlib 模块是之前 imp 模块和 importlib 模块的合集。

## `execfile`

在 Python 2 中有一个 `execfile` 函数，利用它可以用来执行一个文件。

语法如下：

```py
execfile(filename[, globals[, locals]])
```

参数有这么几个：

- `filename`：文件名。
- `globals`：变量作用域，全局命名空间，如果被提供，则必须是一个字典对象。
- `locals`：变量作用域，局部命名空间，如果被提供，可以是任何映射对象。

```py
>>> execfile("/usr/lib64/python2.7/os.py")
>>> 
>>> getcwd()
'/home/wangbm'
```

## `exec`

`execfile` 只能在 Python2 中使用，Python 3.x 里已经删除了这个函数。

但是原理值得借鉴，可以使用 `open ... read` 读取文件内容，然后再用 `exec` 去执行模块。

示例如下：

```py
>>> with open("/usr/lib64/python2.7/os.py", "r") as f:
...     exec(f.read())
... 
>>> getcwd()
'/home/wangbm'
```