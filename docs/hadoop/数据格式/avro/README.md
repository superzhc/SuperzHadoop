# Avro

Avro 是 Hadoop 中的一个子项目，也是 Apache 中一个独立的项目，Avro 是一个基于二进制数据传输高性能的中间件。

Avro 是一个数据序列化的系统，它可以提供：

1. 丰富的数据结构类型
2. 快速可压缩的二进制数据形式
3. 存储持久数据的文件容器
4. 远程过程调用 RPC
5. 简单的动态语言结合功能，Avro 和动态语言结合后，读写数据文件和使用 RPC 协议都不需要生成代码，而代码生成作为一种可选的优化只值得在静态类型语言中实现。

Avro 支持跨编程语言实现（C，C++，C#，Java，Python，Ruby，PHP），Avro 提供着与诸如 Thrift 和 Protocol Buffers 等系统相似的功能，但是在一些基础方面还是有区别的，主要是：

1. 动态类型：Avro 并不需要生成代码，模式和数据存放在一起，而模式使得整个数据的处理过程并不生成代码、静态数据类型等等。这方便了数据处理系统和语言的构造。
2. 未标记的数据：由于读取数据的时候模式是已知的，那么需要和数据一起编码的类型信息就很少了，这样序列化的规模也就小了。
3. 不需要用户指定字段号：即使模式改变，处理数据时新旧模式都是已知的，所以通过使用字段名称可以解决差异问题。

## Schema

Schema 通过 JSON 对象表示。Schema 定义了简单数据类型和复杂数据类型，其中复杂数据类型包含不同属性；通过各种数据类型用户可以自定义丰富的数据结构。

**基本类型**

| 类型    | 说明           |
| ------- | -------------- |
| null    | 空值           |
| boolean | 布尔类型       |
| int     | 整数类型       |
| long    | 长整数类型     |
| float   | 单精度浮点类型 |
| double  | 双精度浮点类型 |
| bytes   | 字节类型       |
| string  | 字符串类型     |

**复杂数据类型**

Avro 定义了六种复杂数据类型：

| 类型       | 属性      | 二级属性 | 描述                                                                  | 是否必须 |
| ---------- | --------- | -------- | --------------------------------------------------------------------- | -------- |
| **Record** |           |          |                                                                       |          |
| record     |           |          | 任意类型的一个命名字段集合，JSON对象表示                              |          |
|            | name      |          | 名称                                                                  | √        |
|            | namespace |          | 命名空间                                                              |          |
|            | doc       |          |                                                                       |          |
|            | aliases   |          |                                                                       |          |
|            | fields    |          | 一个 JSON 数组                                                        | √        |
|            |           | name     |                                                                       |          |
|            |           | doc      |                                                                       |          |
|            |           | type     |                                                                       |          |
|            |           | default  |                                                                       |          |
|            |           | order    |                                                                       |          |
|            |           | aliases  |                                                                       |          |
| **Enum**   |           |          |                                                                       |          |
| enum       |           |          |                                                                       |          |
|            | name      |          |                                                                       | √        |
|            | namespace |          |                                                                       |          |
|            | doc       |          |                                                                       |          |
|            | aliases   |          |                                                                       |          |
|            | symbols   |          | 枚举值，如：`["Mon","Thu","Wed]`                                      | √        |
| **Array**  |           |          | 示例：`{"type": "array", "items": "string"}`                          |          |
| array      |           |          | 未排序的对象集合，对象的模式必须相同                                  |          |
|            | items     |          |                                                                       |          |
| **Map**    |           |          | 示例：`{"type": "map", "values": "long"}`                             |          |
| map        |           |          | 未排序的对象键/值对。键必须是字符串，值可以是任何类型，但必须模式相同 |          |
|            | values    |          |                                                                       |          |
| **Fixed**  |           |          | 示例：`{"type": "fixed", "size": 16, "name": "md5"}`                  |          |
| fixed      |           |          | 一组固定数量的8位无符号字节                                           |          |
|            | name      |          |                                                                       | √        |
|            | namespace |          |                                                                       |          |
|            | size      |          |                                                                       |          |
|            | aliases   |          |                                                                       |          |
| **Union**  |           |          |                                                                       |          |
| union      |           |          | 模式的并集，可以用JSON数组表示，每个元素为一个模式                    |          |


*Record 类型*

```json

```

*Enum 类型*

```json

```