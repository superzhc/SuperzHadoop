# 系统属性

> conf 目录中的 `nifi.properties` 文件是用于控制 NiFi 运行方式的主要配置文件。
>
> 注意：更改 `nifi.properties` 文件后，重新启动NiFi以使更改生效。

## 核心属性

属性 描述
`nifi.flow.configuration.file*` 流配置文件的位置(即包含当前在NiFi图上显示的内容的文件)。默认值为 `./conf/flow.xml.gz`。
`nifi.flow.configuration.archive.enabled*` 指定 NiFi 是否在更新流时自动创建流的备份副本。默认值为 `true`。
`nifi.flow.configuration.archive.dir*` 存档目录的位置，其中保存了 `flow.xml` 的备份副本。默认值为 `./conf/archive`。NiFi 根据归档文件的生命周期，总大小和文件数删除旧的存档文件，以限制磁盘使用。分别使用 `nifi.flow.configuration.archive.max.time`，`max.storage` 和 `max.count` 属性指定生命周期，总大小和文件数。如果未指定归档的这些限制，则 NiFi 使用默认条件，即 `30 days` `max.time` 和 `500 MB` `max.storage`。此清理机制仅考虑自动创建的归档 `flow.xml` 文件。如果此存档目录中有其他文件或目录，NiFi 将忽略它们。自动创建的存档具有带ISO 8601格式时间戳前缀的文件名，后跟`<original-filename>`。即`<year><month><day>T<hour><minute><second>+<timezone offset>_<original filename>`。例如，`20160706T160719+0900_flow.xml.gz`。NiFi在清理存档目录时会检查文件名。如果你想在此目录中保留特定存档而不必担心NiFi删除它，你可以通过使用不同的文件名模式复制它。
`nifi.flow.configuration.archive.max.time*` 归档的 _`flow.xml`_ 文件的生命周期。如果指定了此属性，NiFi将在更新 `flow.xml` 时删除过期的归档文件。到期时间取决于当前系统时间和已归档 `flow.xml` 的上次修改时间戳。如果在 `nifi.properties` 中未指定存档限制，则NiFi将删除早于30 days的存档。
`nifi.flow.configuration.archive.max.storage*` 存档的 `flow.xml` 文件允许的总数据大小。如果指定了此属性，NiFi将删除最早的归档文件，直到总归档文件大小小于此配置值。如果在 `nifi.properties` 中未指定存档限制，则NiFi会使用500 MB此限制。
`nifi.flow.configuration.archive.max.count*` 允许的归档文件数。如果指定了此属性，NiFi将删除最旧的存档文件，以便只保留N个最新存档。
`nifi.flowcontroller.autoResumeState` 指示重新启动时NiFi上的组件是否应返回重启之前的状态。默认值为 `true`。
`nifi.flowcontroller.graceful.shutdown.period` 表示关机时间。默认值为 `10 secs`。
`nifi.flowservice.writedelay.interval` 当对 `flow.xml` 进行许多更改时，此属性指定在写出更改之前等待的时间，以便批量写入。默认值为500 ms。
`nifi.administrative.yield.duration` 如果一个组件允许一个意外的异常被转义，那么它就被认为是一个bug。因此，框架将暂停(或在管理上放弃)组件这段时间。这样做是为了使组件不会因为已知在现有状态下存在的问题而消耗大量的系统资源。默认值为 `30 secs`。
`nifi.bored.yield.duration` 当一个组件没有工作要做(即无聊)时，这是它在检查是否有新数据要工作之前等待的时间。这样，它不会过多地检查新工作而耗尽CPU资源。设置此属性时，请注意它可能会为不经常工作的组件添加额外的延迟，因为一旦进入这种无聊状态，他们将等待这段时间后再检查更多工作。默认值为10 ms。
`nifi.queue.backpressure.count` 在两个组件之间绘制新连接时，这是该连接的背压对象阈值的默认值。默认值为10000，且值必须为整数。
`nifi.queue.backpressure.size` 在两个组件之间绘制新连接时，这是该连接的背压数据大小阈值的默认值。默认值为1 GB，值必须是包含度量单位的数据大小。
`nifi.authorizer.configuration.file*` 这是指定如何定义授权程序的文件的位置。默认值为 `./conf/authorizers.xml`。
`nifi.login.identity.provider.configuration.file*` 这是指定如何执行用户名/密码身份验证的文件的位置。仅在 `nifi.security.user.login.identity.provider` 配置了提供者标识符时才考虑此文件。默认值为 `./conf/login-identity-providers.xml`。
`nifi.templates.directory*` 这是保存流模板的目录的位置(仅用于向后兼容)。模板存储在 `flow.xml.gz` 中，从 NiFi 1.0开始。模板目录可用于在NiFi启动时自动(批量)将模板导入到 `flow.xml.gz` 中。默认值为 `./conf/templates`。
`nifi.ui.banner.text` 这是横幅文本，可配置为显示在用户界面的顶部。默认为空白。
`nifi.ui.autorefresh.interval` 用户界面自动刷新的时间间隔。默认值为 `30 secs`。
`nifi.nar.library.directory` nar库的位置。默认值是 `./lib`，可保持原样。注意：可以使用 nifi.nar.library.directory.带有唯一后缀的前缀和单独的路径作为值来指定其他库目录。例如，要提供两个额外的库位置，用户还可以使用以下键指定其他属性：`nifi.nar.library.directory.lib1=/nars/lib1` `nifi.nar.library.directory.lib2=/nars/lib2` 提供三个总位置，包括 `nifi.nar.library.directory`。
`nifi.nar.working.directory` nar工作目录的位置。默认值是 `./work/nar`，可保持原样。
`nifi.documentation.working.directory` 文档工作目录。默认值是 `./work/docs/components`，可保持原样。
`nifi.processor.scheduling.timeout` 在调用其他生命周期操作(例如，stop)之前，等待处理器的生命周期操作(`@OnScheduled` 和 `@OnUnscheduled`)完成的时间。默认值是 1 分钟。

## State 管理

属性 描述
`nifi.state.management.configuration.file` 包含本地和集群范围的状态提供程序的配置的XML文件。默认值为 `./conf/state-management.xml`。
`nifi.state.management.provider.local` 要使用的本地状态提供程序的ID。此值必须与 `state-management.xml` 文件中某个 local-provider 元素的id值匹配。
`nifi.state.management.provider.cluster` 要使用的集群状态提供程序的ID。此值必须与 `state-management.xml` 文件中某个 cluster-provider 元素的 id 值匹配。如果不是集群，则忽略此值，但集群中的节点需要此值。
`nifi.state.management.embedded.zookeeper.start` 指定此NiFi实例是否应启动嵌入式ZooKeeper服务器。它与 ZooKeeperStateProvider 一起使用。
`nifi.state.management.embedded.zookeeper.properties` 指定一个属性文件，其中包含已启动的嵌入式ZooKeeper服务器的配置(如果该 `nifi.state.management.embedded.zookeeper.start` 属性设置为 true)

## 站点到站点属性(Site to Site Properties)

这些属性控制在数据流中配置远程进程组时，此 NiFi 实例如何与远程 NiFi 实例通信。远程进程组可以从 RAW 和 HTTP 中选择传输协议。命名的属性 `nifi.remote.input.socket.*` 是特定于 RAW 传输协议的。同样，`nifi.remote.input.http.*` HTTP 传输协议特定属性。

|属性| 描述|
|---------|------------------|
|`nifi.remote.input.host`| 将发送给客户端以连接到此 NiFi 实例以进行站点到站点通信的主机名。默认情况下，它是来自的值 `InetAddress.getLocalHost().getHostName()`。在类 UNIX 操作系统上，这通常是 hostname 命令的输出。|
|`nifi.remote.input.secure`| 这表明此 NiFi 实例与远程 NiFi 实例之间的通信是否应该是安全的。默认情况下，它设置为 false。要使安全的站点到站点工作，请将属性设置为 true。还必须配置许多其他安全属性 (opens new window)。|
|`nifi.remote.input.socket.port`| 用于站点到站点通信的远程输入套接字端口。默认情况下，它是空白的，但它必须具有一个值才能使用 RAW 套接字作为站点到站点的传输协议。|
|`nifi.remote.input.http.enabled`| 指定是否应在此主机上启用 HTTP 站点到站点。默认情况下，它设置为 true。站点到站点客户端是使用 HTTP 还是 HTTPS 取决于 `nifi.remote.input.secure`。如果设置为 `true`，则将请求作为 HTTPS 发送到 `nifi.web.https.port`。如果设置为 `false`，则发送 HTTP 请求 `nifi.web.http.port`。| 
|`nifi.remote.input.http.transaction.ttl` | 指定事务在服务器上保持活动状态的时间。默认情况下，它设置为 `30 secs`。如果站点到站点客户端在这段时间之后没有继续进行下一个操作，则从远程 NiFi 实例中丢弃该事务。例如，当客户端创建事务但不发送或接收流文件时，或者客户端发送或接收流文件但未确认该事务时。|
|`nifi.remote.contents.cache.expiration` | 指定 NiFi 在通过站点到站点进行通信时应缓存有关远程 NiFi 实例的信息的时间。默认情况下，NiFi 将缓存来自远程系统的响应 `30 secs`。这允许 NiFi 避免不断地向远程系统发出 HTTP 请求，这在 NiFi 的这个实例具有许多远程进程组实例时尤为重要。|

## WEB 属性

属性 描述
`nifi.web.war.directory` 这是 web war 目录的位置。默认值为 `./lib`。
`nifi.web.http.host` HTTP主机。默认为空白。
`nifi.web.http.port` HTTP端口。默认值为 8080。
`nifi.web.http.port.forwarding` 将传入的 HTTP 请求转发到的端口 `nifi.web.http.host`。此属性旨在与"端口转发"一起使用，当 NiFi 必须由非 root 用户启动以获得更好的安全性时，需要通过低端口访问以通过防火墙。例如，要在端口 80 上通过HTTP协议公开 NiFi，但实际上在端口 8080 上侦听，则需要配置 OS 级别端口转发，例如` iptables(Linux/Unix)` 或 `pfctl(OS X)` 将请求从 80 重定向到 8080，然后设置`nifi.web.http.port` 如 8080和 `nifi.web.http.port.forwarding` 80。默认为空。
`nifi.web.http.network.interface*` NiFi 应为 HTTP 请求绑定的网络接口的名称。默认为空白。注意：可以使用 `nifi.web.http.network.interface.` 带有唯一后缀的前缀和单独的网络接口名称作为值来指定多个网络接口。例如，要提供两个额外的网络接口，用户还可以使用以下键指定其他属性：
`nifi.web.http.network.interface.eth0=eth0`
`nifi.web.http.network.interface.eth1=eth1` 提供三个总网络接口，包括 `nifi.web.http.network.interface.default`。
`nifi.web.https.host` HTTPS主机。默认为空白。
`nifi.web.https.port` HTTPS端口。默认为空白。配置NiFi以安全运行时，应配置此端口。
`nifi.web.https.port.forwarding` `nifi.web.http.port.forwarding` 与 HTTP 相同，但使用 HTTPS进行安全通信。默认为空白。
`nifi.web.https.network.interface*` NiFi应为HTTPS请求绑定的网络接口的名称。默认为空白。注意：可以使用 `nifi.web.https.network.interface.` 带有唯一后缀的前缀和单独的网络接口名称作为值来指定多个网络接口。 例如，要提供两个额外的网络接口，用户还可以使用以下键指定其他属性：
nifi.web.https.network.interface.eth0=eth0
nifi.web.https.network.interface.eth1=eth1 提供三个总网络接口，包括nifi.web.https.network.interface.default。
`nifi.web.jetty.working.directory` Jetty工作目录的位置。默认值为./work/jetty。
`nifi.web.jetty.threads` Jetty线程的数量。默认值为200。
`nifi.web.max.header.size` 请求和响应标头允许的最大大小。默认值为16 KB。
`nifi.web.proxy.host` 以逗号分隔的允许的HTTP主机标头值列表，当NiFi安全运行时将考虑这些值，并且将接收到与其绑定的不同主机 `[：port]` 的请求。例如，在 Docker 容器中运行或在代理后面运行时(例如`localhost：18443`，`proxyhost：443`)。默认情况下，此值为空，表示NiFi应仅允许发送到NiFi绑定的主机 `[：port]` 的请求。
`nifi.web.proxy.context.path` 要考虑的允许 HTTP X-ProxyContextPath，X-Forwarded-Context 或 X-Forwarded-Prefix 标头值的逗号分隔列表。默认情况下，此值为空，表示拒绝包含代理上下文路径的所有请求。配置此属性将允许此列表中包含代理路径的请求。