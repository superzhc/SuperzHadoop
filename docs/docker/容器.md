# 容器：Container

## 操作

### `docker ps`：查看容器

```bash
#查看所有容器
docker ps -a

#查看所有运行的容器
docker ps
```

### `docker [container] run [options]`：启动新容器

| 参数            | 描述                                                             | 示例                 |
| --------------- | ---------------------------------------------------------------- | -------------------- |
| `-a`            | 指定标准输入输出内容类型，可选 STDIN/STDOUT/STDERR 三项          | `-a stdin`           |
| `-d`            | 后台运行容器，并返回容器ID                                       |                      |
| `-i`            | 以交互模式运行容器，通常与 `-t` 同时使用                         |                      |
| `-h`            | 指定容器的 hostname                                              |                      |
| `-P`            | 随机端口映射，容器内部端口随机映射到主机的端口                   |                      |
| `-p`            | 指定端口映射，格式为：`主机(宿主)端口:容器端口`                  |                      |
| `-t`            | 为容器重新分配一个伪输入终端，通常与 `-i` 同时使用               |                      |
| `--volume`/`-v` | 绑定一个卷                                                       |                      |
| `-m`            | 设置容器使用内存最大值                                           |                      |
| `-e`            | 设置环境变量                                                     | `-e username="root"` |
| `--name`        | 为容器指定一个名称                                               |                      |
| `--dns`         | 指定容器使用的 DNS 服务器，默认和宿主一致                        |                      |
| `--dns-search`  | 指定容器 DNS 搜索域名，默认和宿主一致                            |                      |
| `--env-file`    | 从指定文件读入环境变量                                           |                      |
| `--cpuset`      | 绑定容器到指定 CPU 运行                                          |                      |
| `--net`         | 指定容器的网络连接类型，支持 bridge/host/none/container 四种类型 |                      |
| `--link`        | 添加链接到另一个容器                                             |                      |
| `--expose`      | 开放一个端口或一组端口                                           |                      |

### `docker [container] start <container_id>`：启动已终止容器

<!-- 可以利用 `docker [container] start <container_id>` 命令，直接将一个已经终止的容器启动运行 -->

### `docker [container] stop <container_id>`：终止容器

<!-- 可以使用 `docker [container] stop <container_id>` 来终止一个运行中的容器。此外，当 Docker 容器中指定的应用终结时，容器也自动终止。 -->

### `docker [container] rm <container_id>`：删除容器

<!-- 可以使用 `docker container rm <container_id>` 来删除一个处于终止状态的容器。 -->

### `docker [container] inspect <container_id>`:显示容器的配置细节和运行时信息

### 查看容器内运行的进程

```sh
docker top <container_name>

docker top <container_id>
```

**查看所有容器运行的进程**

*Linux*

```sh
for i in  `docker ps |grep Up|awk '{print $1}'`;do echo \ &&docker top $i; done
```

### 获取容器日志

```sh
docker logs -f node
```

### 容器与主机之间的数据拷贝

```sh
#从容器里复制数据到主机
docker cp CONTAINER:SRC_PATH DEST_PATH

#从主机里复制数据到容器
docker cp SRC_PATH CONTAINER:DEST_PATH
```

### 进入后台运行容器

在使用 `-d` 参数时，容器启动后会进入后台。某些时候需要进入容器进行操作：`docker exec 命令 -i -t 参数`。

**以 root 用户的身份进入容器**

```bash
docker exec -it --user root <container id> /bin/bash
```