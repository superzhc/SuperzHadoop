# 元数据

- 业务元数据（Business metadata）：B
- 技术元数据（Technical metadata）：T
- 操作元数据（Metaphorical data）：M

## 内部数据源

**数据源**

**表元数据**

| name                       | desc   | type | note |
|----------------------------|--------|------|------|
| datasource_id              | 所属数据源  | T    |      |
| table_name                 | 表名     | T    |      |
| table_comment              | 表注释    | T    |      |
| ~~table_size~~             | 表大小    | T    |      |
| ~~table_rows~~             | 表行数    | T    |      |
| ~~table_partition~~        | 表分区    | T    |      |
| ~~table_store_type~~       | 表存储类型  | T    |      |
| ~~table_business_meaning~~ | 表业务含义  | B    |      |
| creator                    | 创建者    | M    |      |
| create_date                | 创建时间   | M    |      |
| update_date                | 更新时间   | M    |      |

**字段元数据**

> 外部数据源的字段元数据是否同步，同步频率，保持一致性？

| name                    | desc   | type | note |
|-------------------------|--------|------|------|
| table_id                | 所属表    | T    |      | 
| column_name             | 字段名    | T    |      |
| column_comment          | 字段注释   | T    |      |
| column_type             | 字段类型   | T    |      |
| column_length           | 字段长度   | T    |      |
| column_precision        | 字段精度   | T    |      |
| column_scale            | 字段小数位  | T    |      |
| column_default          | 字段默认值  | T    |      |
| column_is_primary_key   | 是否主键   | T    |      |
| column_nullable         | 是否为空   | T    |      |
| column_is_auto_increase | 是否自增   | T    |      |
| column_is_foreign_key   | 是否外键   | T    |      |
| column_business_meaning | 字段业务含义 | B    |      |
| ~~creator~~             | 创建者    | M    |      |
| ~~create_date~~         | 创建时间   | M    |      |
| ~~update_date~~         | 更新时间   | M    |      |

> 通过表元数据和字段元数据生成 DDL 语句

**表/字段变更日志**？？？

## 外部数据源

> 外部数据源，系统仅可通过配置外部数据源的访问方式，通过 "_元数据采集工具_" 获取外部数据源的元数据信息进行查看，不能进行增删改操作

### PostgreSQL

> 直接采用 JDBC 通用模式来获取

### Hudi

> Hudi 支持元数据表，可通过配置参数 `hoodie.metadata.enable` 来配置开启关闭
>
> 注意：
> 1. 对于 0.10.1 及之前的版本，默认情况是禁用元数据表
> 2. 开启参数需要在读写两端同时开启
>
> 若未开启元数据表，需要 _“列出文件”_ 来获取元数据

### Elasticsearch

> es 提供相关 api 接口来获取

**API**

- `/_cat/indices`：获取所有索引
- `/<index_name>/_mapping`：获取索引的映射，【注意：自动映射的类型不准确】

## 数据血缘

1. 底层存储需使用 **图数据库** ？？？
2. 外部数据源的元信息不在系统中，静态 SQL 无法对数据源判断是外部还是系统内部

**血缘关联关系表**

> 表如何判定内外部数据源

### 表级血缘

| name   | desc    | type | note |
|--------|---------|------|------|
| input  | source  |      |      |
| output | target  |      |      |

### 字段血缘\[暂置\]